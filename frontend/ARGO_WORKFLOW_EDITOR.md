# Argo Workflow 可视化编辑器

## 功能特性

本可视化编辑器基于 Vue Flow 库构建，提供了直观的 Argo Workflow 配置编辑体验。

### 主要功能

1. **可视化编辑**

   - 拖拽添加和编辑 workflow 步骤
   - 可视化连接步骤之间的依赖关系
   - 实时预览 workflow 结构

2. **步骤属性编辑**

   - 点击步骤节点打开属性编辑面板
   - 编辑容器镜像、执行命令、参数等
   - 配置环境变量和资源限制

3. **YAML 同步**
   - 可视化编辑与 YAML 代码实时同步
   - 支持在可视化编辑器和 YAML 编辑器之间切换
   - 自动格式化和验证 YAML 语法

## 使用方法

### 1. 添加步骤

- 点击工具栏中的"添加步骤"按钮
- 新步骤将出现在画布上
- 可以拖拽移动步骤位置

### 2. 编辑步骤属性

- 点击任意步骤节点
- 右侧将打开属性编辑面板
- 可以编辑以下属性：
  - 步骤名称
  - 容器镜像
  - 执行命令
  - 参数列表
  - 环境变量
  - 资源限制（CPU/内存）

### 3. 连接步骤

- 从步骤的输出端口拖拽到另一个步骤的输入端口
- 建立步骤之间的依赖关系

### 4. 删除步骤

- 选中要删除的步骤
- 点击工具栏中的"删除选中"按钮
- 或直接按 Delete 键

### 5. 视图控制

- 使用右上角的控制按钮进行缩放和适应视图
- 使用鼠标滚轮进行缩放
- 拖拽画布进行平移

## 支持的 Argo Workflow 特性

### 基本容器步骤

```yaml
- name: step-name
  container:
    image: alpine:latest
    command: [echo]
    args: ['Hello World']
    env:
      - name: ENV_VAR
        value: 'value'
    resources:
      requests:
        memory: '64Mi'
        cpu: '250m'
      limits:
        memory: '128Mi'
        cpu: '500m'
```

### 步骤依赖

- 通过可视化连接建立步骤间的依赖关系
- 自动生成 `dependencies` 字段

## 技术实现

### 依赖库

- **Vue Flow**: 流程图可视化库
- **js-yaml**: YAML 解析和生成
- **Element Plus**: UI 组件库

### 核心组件

- `ArgoWorkflowEditor.vue`: 主编辑器组件
- `WorkflowNode.vue`: 步骤节点组件
- `TemplateEdit.vue`: 集成页面

### 数据流

1. YAML 配置 → 解析为节点和边
2. 可视化编辑 → 更新节点和边
3. 节点和边 → 转换为 YAML 配置

## 扩展功能

### 计划中的功能

- 条件分支节点
- 并行执行节点
- 循环节点
- 输入/输出参数配置
- 工作流模板管理
- 实时预览执行状态

### 自定义节点类型

- 支持不同类型的节点（构建、测试、部署等）
- 自定义节点图标和样式
- 节点特定的属性编辑界面

## 故障排除

### 常见问题

1. **YAML 解析错误**

   - 检查 YAML 语法是否正确
   - 确保 Argo Workflow 格式符合规范

2. **节点无法连接**

   - 确保从输出端口拖拽到输入端口
   - 检查是否有循环依赖

3. **属性编辑面板不显示**
   - 确保点击了节点而不是画布
   - 检查浏览器控制台是否有错误

### 调试模式

- 打开浏览器开发者工具
- 查看控制台输出的调试信息
- 检查网络请求和响应

## 贡献指南

欢迎提交 Issue 和 Pull Request 来改进这个编辑器。

### 开发环境设置

```bash
cd frontend
npm install
npm run dev
```

### 代码规范

- 使用 TypeScript 进行类型检查
- 遵循 Vue 3 Composition API 规范
- 使用 ESLint 和 Prettier 进行代码格式化
